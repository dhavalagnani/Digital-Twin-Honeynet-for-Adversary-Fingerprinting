# Digital Twin Honeynet - Cowrie Configuration
# SSH honeypot configuration for adversary fingerprinting

[output_jsonlog]
enabled = true
logfile = logs/cowrie.json

[output_logfiles]
enabled = true
logfile = logs/cowrie.log

[ssh]
enabled = true
port = 2222
# Production server SSH version string - matches real server exactly
version = SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5
hostname = production-server

# Banner randomization settings for enhanced fingerprinting protection
[banner]
# Enable/disable banner randomization (true = randomize, false = use production banner)
enabled = false
# Production server banner (used when randomization is disabled)
production_banner = SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5
# Alternative realistic banners for randomization mode (comma-separated)
alternative_banners = SSH-2.0-OpenSSH_8.4p1 Ubuntu-5ubuntu1.1,SSH-2.0-OpenSSH_8.1p1 Debian-1+deb11u2,SSH-2.0-OpenSSH_8.3p1 Ubuntu-1ubuntu1,SSH-2.0-OpenSSH_7.9p1 Debian-10+deb10u2
# Banner rotation interval in seconds (0 = rotate per connection)
rotation_interval = 0

# Banner response timing configuration
[banner_timing]
# Enable randomized banner delay to mimic real server latency
enabled = true
# Base delay before sending banner (seconds)
base_delay = 0.05
# Jitter range for randomization (±seconds)
jitter_range = 0.02
# Minimum delay (seconds)
min_delay = 0.01
# Maximum delay (seconds)
max_delay = 0.15
# Enable connection-specific delay variation
connection_variation = true

[shell]
enabled = true
honeypot = true

[logins]
enabled = true
# Valid username/password combinations for legitimate access
users = admin:admin123, root:password, test:test123, user1:secure_password_2024

[filesystem]
enabled = true
contents_path = fs

[commands]
enabled = true
honeypot = true

[download]
enabled = true
download_path = downloads

[output_mysql]
enabled = false

[output_elasticsearch]
enabled = false

[output_splunk]
enabled = false

[output_kafka]
enabled = false

# Honeypot behavior settings (merged with existing shell section)

# Session settings
[session]
timeout = 600
max_attempts = 10

# Logging settings (merged with existing output_jsonlog section)

# Performance settings
[performance]
max_sessions = 100
max_connections = 1000
connection_timeout = 30

# Authentication message configuration
[auth_messages]
# Enable authentication message customization
enabled = true
# Production server authentication failure message
auth_failure_msg = Permission denied, please try again.
# Production server authentication success message (if any)
auth_success_msg = 
# Invalid username message
invalid_username_msg = Invalid username.
# Account locked message
account_locked_msg = Account locked due to too many failed attempts.
# Maximum failed attempts before lockout
max_failed_attempts = 5
# Lockout duration in seconds
lockout_duration = 3600

# Session response configuration
[session_responses]
# Enable session response customization
enabled = true
# Production server welcome message
welcome_msg = Welcome to Ubuntu 20.04.5 LTS (GNU/Linux 5.4.0-135-generic x86_64)
# Last login message format
last_login_format = Last login: {timestamp} from {ip}
# Command prompt style (matches production server)
prompt_style = {username}@{hostname}:{path}$
# Default shell prompt
default_prompt = admin@production-server:~$
# Root prompt style
root_prompt = root@production-server:~#
# Command not found message
command_not_found = {command}: command not found
# Permission denied message
permission_denied = Permission denied

# Disconnect and error message configuration
[disconnect_messages]
# Enable disconnect message customization
enabled = true
# Normal disconnect message
normal_disconnect = Connection closed by remote host.
# Timeout disconnect message
timeout_disconnect = Connection timed out.
# Protocol error message
protocol_error = Protocol error.
# Authentication timeout message
auth_timeout = Authentication timeout.
# Maximum sessions exceeded message
max_sessions_msg = Maximum number of sessions exceeded.

# Timestamp and formatting configuration
[timestamp_formatting]
# Enable timestamp customization to match production server
enabled = true
# Date format for command output timestamps
date_format = %a %b %d %H:%M:%S %Y
# Timezone for timestamps (matches production server)
timezone = UTC
# Enable realistic command execution timing
command_timing = true
# Base command execution delay (seconds)
base_command_delay = 0.1
# Command execution jitter (±seconds)
command_jitter = 0.05
# Enable file listing timing simulation
file_listing_timing = true
# Directory listing delay (seconds)
dir_listing_delay = 0.2

# Production server fingerprinting settings
[production_matching]
# Enable strict production server matching mode
enabled = true
# Match production server's SSH protocol version exactly
strict_protocol_version = true
# Match production server's key exchange algorithms
match_kex_algorithms = true
# Match production server's encryption algorithms
match_encryption_algorithms = true
# Match production server's MAC algorithms
match_mac_algorithms = true
# Match production server's compression algorithms
match_compression_algorithms = true
# Match production server's host key algorithms
match_host_key_algorithms = true

# Security settings
[security]
allowed_ips = 192.168.1.0/24, 10.0.0.0/8, 172.16.0.0/12
blocked_ips = 
max_failed_logins = 5
block_duration = 3600 